- config:
    name: 创建、更新、查询某个属性
    base_url: ${ENV(product_service_host)}
    variables:
        - unexisted_attribute_id: 10000

- test:
    name: 创建属性-name不同于其他属性名称
    request:
        method: POST
        url: /attributes
        headers:
            Content-Type: application/json
        json:
            name: ${attribute_name()}
    validate:
        - eq: [status_code, 200]
    extract:
        - created_attribute_code: status_code
        - created_attribute_id: content


- test:
      name: 创建属性-name同于其他属性名称
      request:
          method: POST
          url: /attributes
          headers:
              Content-Type: application/json
          json:
              name: '课时券'
      validate:
          - eq: [status_code, 500]

- test:
      name: 创建属性-属性name为空
      request:
          method: POST
          url: /attributes
          headers:
              Content-Type: application/json
          json:
              name: ''
      validate:
          - eq: [status_code, 400]

- test:
      name: 创建属性-属性name长度超过40
      request:
          method: POST
          url: /attributes
          headers:
              Content-Type: application/json
          json:
              name: ${generate_random_str(41)}
      validate:
          - eq: [status_code, 400]


- test:
      name: 更新属性名称-attribute_id存在，name不同于其他属性名称
      skipUnless: ${eval_equal($created_attribute_code, 200)}
      request:
          method: PUT
          url: /attributes/$created_attribute_id
          headers:
              Content-Type: application/json
          json:
              name: ${attribute_name()}
      validate:
          - eq: [status_code, 200]

- test:
      name: 更新属性名称-attribute_id存在，name同于其他属性名称
      skipUnless: ${eval_equal($created_attribute_code, 200)}
      request:
          method: PUT
          url: /attributes/$created_attribute_id
          headers:
              Content-Type: application/json
          json:
              name: '课时券'
      validate:
          - eq: [status_code, 500]

- test:
      name: 更新属性名称-attribute_id存在，name为空
      skipUnless: ${eval_equal($created_attribute_code, 200)}
      request:
          method: PUT
          url: /attributes/$created_attribute_id
          headers:
              Content-Type: application/json
          json:
              name: ''
      validate:
          - eq: [status_code, 400]

- test:
      name: 更新属性名称-attribute_id不存在，name不同于其他属性名称
      request:
          method: PUT
          url: /attributes/$unexisted_attribute_id
          headers:
              Content-Type: application/json
          json:
              name: ${attribute_name()}
      validate:
          - eq: [status_code, 200]
          - eq: [content,false]

- test:
      name: 更新属性名称-attribute_id为空，name不同于其他属性名称
      request:
          method: PUT
          url: /attributes/
          headers:
              Content-Type: application/json
          json:
              name: ${attribute_name()}
      validate:
          - eq: [status_code, 405]

- test:
      name: 更新属性名称-attribute_id存在，name长度超过40
      skipUnless: ${eval_equal($created_attribute_code, 200)}
      request:
          method: PUT
          url: /attributes/$created_attribute_id
          headers:
              Content-Type: application/json
          json:
              name: ${generate_random_str(41)}
      validate:
          - eq: [status_code, 400]
