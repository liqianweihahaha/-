- config:
    name: 查询属性
    base_url: ${get_product_service_host()}
    variables:
        - unexisted_attribute_id: 10000
        - exitsted_attribute_id: 1

- test:
    name: 准备工作-创建属性
    request:
        method: POST
        url: /attributes
        headers:
            Content-Type: application/json
        json:
            name: '9999'
#            name: ${attribute_name()}
    validate:
        - eq: [status_code, 200]
    extract:
        - create_attribute_status: status_code
        - create_attribute_id: content

- test:
    name: 根据ids批量获取属性列表-ids长度为1，存在
    skipUnless: ${eval_equal($create_attribute_status, 200)}
    request:
        method: GET
        url: /attributes?ids=$create_attribute_id
        headers:
            Content-Type: application/json
    validate:
        - eq: [status_code, 200]
        - type_match: [content,list]
        - length_equals: [content,1]
        - eq: [content.0.id,$create_attribute_id]

- test:
    name: 根据ids批量获取属性列表-ids长度为2，两个属性都存在
    skipUnless: ${eval_equal($create_attribute_status, 200)}
    request:
        method: GET
        url: /attributes?ids=$exitsted_attribute_id,$create_attribute_id
        headers:
            Content-Type: application/json
    extract:
      - attri_id1: content.0.id
      - attri_id2: content.1.id
    validate:
        - eq: [status_code, 200]
        - type_match: [content,list]
        - length_equals: [content,2]
        - eq: [$attri_id1,$exitsted_attribute_id]
        - eq: [$attri_id2,$create_attribute_id]



- test:
    name: 根据ids批量获取属性列表-ids为空
    request:
        method: GET
        url: /attributes?ids=
        headers:
            Content-Type: application/json
    validate:
        - eq: [status_code, 400]

- test:
    name: 根据ids批量获取属性列表-ids长度为1，属性不存在
    request:
        method: GET
        url: /attributes?ids=$unexisted_attribute_id
        headers:
            Content-Type: application/json
    validate:
        - eq: [status_code, 200]
        - length_equals: [content,0]

- test:
    name: 根据ids批量获取属性列表-ids长度为2，属性一个存在，一个不存在
    skipUnless: ${eval_equal($create_attribute_status, 200)}
    request:
        method: GET
        url: /attributes?ids=$create_attribute_id,$unexisted_attribute_id
        headers:
            Content-Type: application/json
    validate:
        - eq: [status_code, 200]
        - length_equals: [content,1]