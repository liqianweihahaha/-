- config:
    name: 获取订单详情页
    base_url: ${ENV(transaction_admin_api_host)}
    verify: False
    variables:
        - existed_customerPhoneNumber: ${order_customerPhoneNumber_config()}
        - existed_skuNumber: ${sku_number_config()}
        - existed_customerId: ${order_customerId_config()}
        - existed_orderPlatform: ALIPAY
        - existed_total_discount: null
        - existed_order_orderId: CM201210146994676980
        - unexisted_order_orderId: 123456


- test:
    name: 已登录内部账号系统-查看普通订单详情页-订单号存在
    request:
        method: GET
        url: orders/$existed_order_orderId/details
        headers:
            Authorization: ${internal_source_user_login_token()}
    validate:
        - eq: [status_code, 200]
        - eq: [content.orderId, $existed_order_orderId]
        - type_match: [content.normalOrderInfo, object]
        - type_match: [content.normalOrderInfo.customerInfo, object]
        - length_equals: [content.normalOrderInfo.customerInfo, 4]
        - type_match: [content.normalOrderInfo.productInfo, list]
        - length_equals: [content.normalOrderInfo.productInfo.0, 10]
        - type_match: [content.normalOrderInfo.paymentInfo, list]
        - type_match: [content.normalOrderInfo.shippingInfo, list]
        - type_match: [content.normalOrderInfo.shippingAddressInfo, object]
        - length_equals: [content.normalOrderInfo.shippingAddressInfo, 7]

- test:
    name: 已登录内部账号系统-查看普通订单详情页-订单号不存在
    request:
        method: GET
        url: orders/$unexisted_order_orderId/details
        headers:
            Authorization: ${internal_source_user_login_token()}
    validate:
        - eq: [status_code, 422]
        - eq: [content.error_code, '10021002']

- test:
    name: 未登录-查看普通订单详情页-订单号存在
    request:
        method: GET
        url: orders/$existed_order_orderId/details
    validate:
        - eq: [status_code, 401]
        - eq: [content.error_code, '10020005']